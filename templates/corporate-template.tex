% Professional Business Plan Template
% Inspired by Anthropic's clean, modern design aesthetic
% Requires XeLaTeX for advanced font support

\documentclass[11pt,letterpaper]{article}

% Essential packages
\usepackage{fontspec}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{tcolorbox}
\usepackage{multicol}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{float}
\usepackage{caption}

% Page geometry - generous margins
\geometry{
    letterpaper,
    left=1.25in,
    right=1.25in,
    top=1.25in,
    bottom=1.25in,
    headheight=15pt
}

% Anthropic-inspired color palette
\definecolor{anthropicOrange}{RGB}{232, 108, 56}      % Warm orange accent
\definecolor{anthropicDarkOrange}{RGB}{191, 76, 33}   % Darker orange
\definecolor{anthroBlack}{RGB}{25, 25, 25}            % Near black
\definecolor{anthroGray}{RGB}{95, 95, 95}             % Medium gray
\definecolor{anthroLightGray}{RGB}{245, 245, 245}     % Very light gray
\definecolor{anthroBlue}{RGB}{45, 109, 164}           % Professional blue

% Font configuration - modern, clean sans-serif
\setmainfont{Inter}[
    Path=./fonts/,
    Extension=.ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    BoldItalicFont=*-BoldItalic
]

% Fallback to system fonts if Inter is not available
\IfFontExistsTF{Inter}{}{
    \setmainfont{Arial}
}

\setsansfont{Inter}[
    Path=./fonts/,
    Extension=.ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold
]

\IfFontExistsTF{Inter}{}{
    \setsansfont{Arial}
}

% Use sans-serif throughout
\renewcommand{\familydefault}{\sfdefault}

% Hyperlink styling
\hypersetup{
    colorlinks=true,
    linkcolor=anthropicOrange,
    urlcolor=anthropicDarkOrange,
    citecolor=anthroBlue,
    pdfborder={0 0 0}
}

% Section formatting - clean and minimal
\titleformat{\section}
    {\color{anthroBlack}\fontsize{24}{28}\bfseries}
    {}
    {0pt}
    {}
    [\vspace{2pt}{\color{anthropicOrange}\titlerule[2pt]}]

\titleformat{\subsection}
    {\color{anthroBlack}\fontsize{16}{20}\bfseries}
    {}
    {0pt}
    {}

\titleformat{\subsubsection}
    {\color{anthroGray}\fontsize{13}{16}\bfseries}
    {}
    {0pt}
    {}

% Spacing
\titlespacing*{\section}{0pt}{24pt}{12pt}
\titlespacing*{\subsection}{0pt}{18pt}{8pt}
\titlespacing*{\subsubsection}{0pt}{12pt}{6pt}

% Header and footer
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\color{anthroGray}$title$}
\fancyhead[R]{\small\color{anthroGray}$if(date)$$date$$endif$}
\fancyfoot[C]{\small\color{anthroGray}\thepage}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\footrulewidth}{0pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{anthroLightGray}\leaders\hrule height \headrulewidth\hfill}}

% Custom title page
\renewcommand{\maketitle}{
    \begin{titlepage}
        \begin{center}
            \vspace*{2cm}

            % Logo if provided
            $if(logo)$
            \includegraphics[width=0.3\textwidth]{$logo$}
            \vspace{1.5cm}
            $endif$

            % Title
            {\fontsize{42}{50}\bfseries\color{anthroBlack}
            $title$
            }

            \vspace{0.5cm}

            % Subtitle
            $if(subtitle)$
            {\fontsize{20}{24}\color{anthroGray}
            $subtitle$
            }
            \vspace{1cm}
            $endif$

            % Orange accent bar
            {\color{anthropicOrange}\rule{0.5\textwidth}{3pt}}

            \vspace{2cm}

            % Author
            $if(author)$
            {\fontsize{16}{20}\color{anthroBlack}
            $author$
            }
            \vspace{0.5cm}
            $endif$

            % Date
            $if(date)$
            {\fontsize{14}{18}\color{anthroGray}
            $date$
            }
            $endif$

            \vfill

            % Version
            $if(version)$
            {\small\color{anthroGray}
            Version $version$
            }
            $endif$

        \end{center}
    \end{titlepage}
}

% Custom boxes for callouts
\newtcolorbox{highlightbox}{
    colback=anthroLightGray,
    colframe=anthropicOrange,
    boxrule=0pt,
    leftrule=4pt,
    arc=0pt,
    left=10pt,
    right=10pt,
    top=8pt,
    bottom=8pt
}

% List styling
\setlist[itemize]{
    leftmargin=*,
    itemsep=4pt,
    parsep=0pt,
    topsep=8pt,
    label={\color{anthropicOrange}\textbullet}
}

\setlist[enumerate]{
    leftmargin=*,
    itemsep=4pt,
    parsep=0pt,
    topsep=8pt,
    label={\color{anthropicOrange}\arabic*.}
}

% Figure and table captions
\captionsetup{
    font={small,sf},
    labelfont={bf,color=anthroBlack},
    textfont={color=anthroGray},
    justification=centering,
    skip=8pt
}

% Paragraph spacing
\setlength{\parindent}{0pt}
\setlength{\parskip}{8pt}

% Better image handling
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

% Table styling
\renewcommand{\arraystretch}{1.3}

% Horizontal rule styling
\renewcommand{\rule}[2]{\textcolor{anthropicOrange}{\rule{#1}{#2}}}

\begin{document}

% Title page
$if(title)$
\maketitle
$endif$

% Clear to right page for two-sided printing
\cleardoublepage

% Table of contents
$if(toc)$
{
\hypersetup{linkcolor=anthroBlack}
\setcounter{tocdepth}{2}
\tableofcontents
\cleardoublepage
}
$endif$

% Main content
$body$

\end{document}
